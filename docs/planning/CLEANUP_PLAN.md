# Project Cleanup Plan

**Generated**: 2025-10-15
**Status**: Awaiting User Confirmation

## Executive Summary

The codebase analysis identified several organizational issues and cleanup opportunities:

1. **Duplicate Supabase Directories**: Two separate `supabase/` locations causing confusion
2. **Misplaced Backend Code**: Backend functions incorrectly located under `src/`
3. **Obsolete Files**: Temporary files, outdated workflows, and source archives
4. **Empty/Placeholder Files**: Guidelines file with no content

**Estimated Impact**: ~88KB disk space recovered, improved project structure clarity

---

## 1. Duplicate Supabase Directories

### Current Structure (PROBLEMATIC)
```
/home/john/facial_sentiment/
├── supabase/                           # Root-level (CORRECT location)
│   └── migrations/
│       └── 001_initial_schema.sql
└── src/
    └── supabase/                       # Nested under src/ (INCORRECT)
        └── functions/
            └── server/
                ├── index.tsx           # Backend API
                └── kv_store.tsx        # Obsolete KV store
```

### Issue Analysis
- **Root `/supabase/`**: Proper location for Supabase configuration, migrations, and Edge Functions
- **Nested `/src/supabase/`**: Incorrectly placed backend code that should NOT be under `src/`
- **Standard Practice**: Backend functions belong in `/supabase/functions/`, not `/src/supabase/functions/`

### Recommended Action
**Move backend functions to proper location:**

```bash
# Move backend functions to correct location
mkdir -p supabase/functions/server
mv src/supabase/functions/server/index.tsx supabase/functions/server/
rm src/supabase/functions/server/kv_store.tsx  # Delete obsolete KV store
rmdir src/supabase/functions/server
rmdir src/supabase/functions
rmdir src/supabase
```

**Impact**:
- ✅ Follows Supabase standard directory structure
- ✅ Clear separation: frontend in `src/`, backend in `supabase/`
- ✅ Aligns with deployment expectations (Supabase CLI looks in `/supabase/functions/`)

---

## 2. Obsolete Backend Files

### Files to Delete

#### `src/supabase/functions/server/kv_store.tsx`
- **Status**: OBSOLETE
- **Reason**: Project migrated from Deno KV to PostgreSQL
- **Usage**: Only imported by `index.tsx` (backend), no frontend dependencies
- **Action**: DELETE (will be removed when backend moves to proper location)

---

## 3. Temporary & Obsolete Documentation Files

### Files to Move to Archive or Delete

#### `Real-time Facial Sentiment Analysis.zip` (88KB)
- **Status**: SOURCE ARCHIVE
- **Reason**: Original project export, not needed for active development
- **Recommendation**:
  - **Option A (Recommended)**: DELETE (can re-download from source if needed)
  - **Option B**: Move to `/archive/` directory for reference
- **Action**: User to decide

#### `WATERFALL_IMPLEMENTATION_WORKFLOW.md` (38KB)
- **Status**: OBSOLETE WORKFLOW
- **Reason**: Superseded by `RAPID_MVP_WORKFLOW.md` and `IMPLEMENTATION_CHECKLIST.md`
- **Contains**: Generic 17-20 week waterfall plan created before codebase analysis
- **Recommendation**: DELETE (information now in current workflow docs)
- **Action**: DELETE

#### `PROJECT_STATUS_ASSESSMENT.md` (23KB)
- **Status**: HISTORICAL ANALYSIS
- **Reason**: Point-in-time assessment, now superseded by current implementation
- **Recommendation**:
  - **Option A**: Keep for historical reference (minimal disk impact)
  - **Option B**: Move to `/docs/historical/` if created
- **Action**: User to decide (recommend KEEP for now)

#### `Create a real-time facial sentiment.txt` (3KB)
- **Status**: ORIGINAL SPECIFICATION
- **Reason**: Source requirements document
- **Recommendation**: KEEP (source of truth for requirements)
- **Action**: KEEP

---

## 4. Empty/Placeholder Files

#### `src/guidelines/Guidelines.md` (empty)
- **Status**: EMPTY PLACEHOLDER
- **Reason**: Contains only 1 blank line, no actual guidelines
- **Action**: DELETE directory if no plans to add guidelines

#### `src/Attributions.md` (3 lines)
- **Status**: MINIMAL BUT VALID
- **Reason**: Contains license attributions for shadcn/ui and Unsplash
- **Action**: KEEP (legal/licensing information)

---

## 5. Misleading `src/utils/supabase/info.tsx`

### Current Location
```
src/utils/supabase/info.tsx  # Contains project ID and anon key
```

### Issue
- **Filename**: `info.tsx` is non-descriptive
- **Auto-generated**: Marked with "AUTOGENERATED FILE - DO NOT EDIT" warning
- **Supabase Standard**: Typically `supabaseClient.ts` or similar

### Recommendation
**Option A (Recommended)**: Rename for clarity
```bash
mv src/utils/supabase/info.tsx src/utils/supabase/config.ts
```

**Option B**: Leave as-is (auto-generated warning suggests it may be managed by tooling)

**Action**: User to decide (recommend rename or investigate generation source)

---

## 6. Documentation Organization

### Current Active Documentation Files
```
/home/john/facial_sentiment/
├── IMPLEMENTATION_CHECKLIST.md      # Current implementation tasks
├── RAPID_MVP_WORKFLOW.md            # Current workflow plan
├── PROJECT_STATUS_ASSESSMENT.md     # Historical analysis
├── WATERFALL_IMPLEMENTATION_WORKFLOW.md  # OBSOLETE
├── CLEANUP_PLAN.md                  # This file
├── README.md                        # Project overview
└── Create a real-time facial sentiment.txt  # Requirements
```

### Recommendation
Create `/docs/` directory structure:

```bash
mkdir -p docs/historical
mkdir -p docs/planning

# Move active planning docs
mv IMPLEMENTATION_CHECKLIST.md docs/planning/
mv RAPID_MVP_WORKFLOW.md docs/planning/

# Move historical analysis (optional)
mv PROJECT_STATUS_ASSESSMENT.md docs/historical/

# Keep at root: README.md, Create a real-time facial sentiment.txt
```

**Impact**: Cleaner root directory, organized documentation

---

## Cleanup Action Plan

### Phase 1: Critical Structure Fixes (REQUIRED)

```bash
# 1. Move backend to proper location
mkdir -p supabase/functions/server
mv src/supabase/functions/server/index.tsx supabase/functions/server/
rm src/supabase/functions/server/kv_store.tsx
rmdir src/supabase/functions/server src/supabase/functions src/supabase

# 2. Delete obsolete workflow
rm WATERFALL_IMPLEMENTATION_WORKFLOW.md

# 3. Delete empty guidelines
rm src/guidelines/Guidelines.md
rmdir src/guidelines
```

**Estimated Time**: 2 minutes
**Risk Level**: LOW (only moving/deleting obsolete files)

---

### Phase 2: Archive Cleanup (RECOMMENDED)

```bash
# Delete source archive (can re-download if needed)
rm "Real-time Facial Sentiment Analysis.zip"
```

**Estimated Time**: 10 seconds
**Risk Level**: NONE (source archive not needed for development)

---

### Phase 3: Documentation Organization (OPTIONAL)

```bash
# Create documentation structure
mkdir -p docs/planning docs/historical

# Organize planning documents
mv IMPLEMENTATION_CHECKLIST.md docs/planning/
mv RAPID_MVP_WORKFLOW.md docs/planning/

# Preserve historical analysis
mv PROJECT_STATUS_ASSESSMENT.md docs/historical/
```

**Estimated Time**: 1 minute
**Risk Level**: NONE (organizational only)

---

## Post-Cleanup Structure

### Expected Directory Tree (After Phase 1)
```
/home/john/facial_sentiment/
├── .claude/                         # Claude configuration
├── scripts/                         # Setup/verification scripts
│   ├── setup-admin.sql
│   └── verify-setup.sql
├── supabase/                        # Supabase configuration (ROOT LEVEL)
│   ├── functions/
│   │   └── server/
│   │       └── index.tsx           # Backend API (MOVED HERE)
│   └── migrations/
│       └── 001_initial_schema.sql
├── src/                             # Frontend code ONLY
│   ├── components/
│   │   ├── figma/
│   │   ├── ui/                     # shadcn/ui components
│   │   ├── AdminDashboard.tsx
│   │   ├── DemographicForm.tsx
│   │   ├── ExperimentDetailsModal.tsx
│   │   ├── ExperimentView.tsx
│   │   ├── PrivacyModal.tsx
│   │   ├── ThankYouModal.tsx
│   │   └── WebcamSetup.tsx
│   ├── styles/
│   ├── utils/
│   │   ├── supabase/
│   │   │   └── info.tsx           # Supabase config
│   │   └── faceapi-loader.ts
│   ├── App.tsx
│   ├── Attributions.md
│   └── main.tsx
├── CLEANUP_PLAN.md                  # This file
├── IMPLEMENTATION_CHECKLIST.md
├── PROJECT_STATUS_ASSESSMENT.md     # Historical reference
├── RAPID_MVP_WORKFLOW.md
├── README.md
├── Create a real-time facial sentiment.txt
├── index.html
├── package.json
└── vite.config.ts
```

---

## Verification Checklist

After cleanup execution:

- [ ] `/src/supabase/` directory no longer exists
- [ ] `/supabase/functions/server/index.tsx` exists and contains backend API
- [ ] `kv_store.tsx` no longer exists anywhere
- [ ] `WATERFALL_IMPLEMENTATION_WORKFLOW.md` deleted
- [ ] `src/guidelines/` directory deleted
- [ ] Project still builds: `npm run build`
- [ ] Backend import paths updated if needed (check for references to old location)

---

## Risk Assessment

### Risks Identified

1. **Backend Import Path Changes**
   - **Risk**: If any code references `src/supabase/functions/...`
   - **Mitigation**: Grep search shows no frontend imports of backend code
   - **Confidence**: HIGH (backend is deployed separately, not imported by frontend)

2. **Deployment Configuration**
   - **Risk**: CI/CD or deployment scripts expect old location
   - **Mitigation**: Supabase CLI expects `/supabase/functions/` (new location is correct)
   - **Confidence**: HIGH (moving TO standard location, not away from it)

3. **Accidental Deletion of Active Code**
   - **Risk**: Deleting wrong files
   - **Mitigation**: All deletions are of obsolete/empty files only
   - **Confidence**: HIGH (careful analysis completed)

### Overall Risk Level: **LOW**

---

## Summary of Changes

| Action | Files Affected | Disk Space | Risk |
|--------|---------------|------------|------|
| Move backend functions | 1 file | 0KB | LOW |
| Delete obsolete KV store | 1 file | ~2KB | NONE |
| Delete obsolete workflow | 1 file | 38KB | NONE |
| Delete empty guidelines | 1 file + dir | ~1KB | NONE |
| Delete source archive | 1 file | 88KB | NONE |
| **TOTAL** | **5 files** | **~129KB** | **LOW** |

---

## User Decisions Required

### ⚠️ Required Confirmation (Phase 1)
- [ ] **Confirm**: Move `src/supabase/functions/` → `supabase/functions/`
- [ ] **Confirm**: Delete `kv_store.tsx` (obsolete Deno KV code)
- [ ] **Confirm**: Delete `WATERFALL_IMPLEMENTATION_WORKFLOW.md` (superseded)
- [ ] **Confirm**: Delete empty `src/guidelines/` directory

### ✅ Recommended (Phase 2)
- [ ] **Decide**: Delete `Real-time Facial Sentiment Analysis.zip` (88KB source archive)

### 🔧 Optional (Phase 3)
- [ ] **Decide**: Rename `src/utils/supabase/info.tsx` → `config.ts` for clarity
- [ ] **Decide**: Organize docs into `/docs/planning/` and `/docs/historical/`
- [ ] **Decide**: Keep or archive `PROJECT_STATUS_ASSESSMENT.md`

---

## Next Steps

**TO PROCEED WITH CLEANUP:**

1. **Review this plan carefully**
2. **Make decisions on optional items** (Phases 2-3)
3. **Confirm you want to execute** Phase 1 (required structure fixes)
4. **I will execute the cleanup commands** and verify success

**TO SKIP CLEANUP:**

Respond "skip cleanup" and I will proceed directly to backend PostgreSQL implementation.

---

**⏸️ HALTED - Awaiting User Confirmation**
